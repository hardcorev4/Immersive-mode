local functions = loadstring(game:HttpGet("https://raw.githubusercontent.com/localplayerr/Doors-stuff/refs/heads/main/Functions"))()

local pcal = game.Lighting.EntityFolder:FindFirstChild("Depth_Model")
if not pcal then warn("Depth model not found") return end
local model = game.Lighting.EntityFolder.Depth_Model

local Entity = model.DepthMoving

local rooms = game.Workspace.CurrentRooms

function MoveTo(speed,pos)
    local distance = (Entity.Position - pos.Position).Magnitude
    local newspeed = distance / speed
    local tweeninfo = TweenInfo.new(newspeed,Enum.EasingStyle.Linear)
    local twening = game:GetService("TweenService"):Create(Entity, tweeninfo, {CFrame = pos})
    twening:Play()
    twening.Completed:Wait()
end

functions.LightRecolor(0.5,Color3.fromRGB(157, 245, 255),Color3.fromRGB(0, 174, 255))

local sound = Instance.new("Sound",game.Workspace)
sound.SoundId = "rbxassetid://12221990"
sound.PlaybackSpeed = 0.2
sound.Volume = 5
local octave = Instance.new("PitchShiftSoundEffect",sound)
octave.Octave = 0.5
local lvl = Instance.new("DistortionSoundEffect",sound)
lvl.Level = 0.85

sound:Play()
wait(2)
sound:Destroy()

model.Parent = game.Workspace
Entity.CFrame = rooms:GetChildren()[1].RoomEntrance.CFrame
task.wait(3)

task.spawn(function()
    while model.Parent and task.wait() do
        local distance = (Entity.Position - pos.Position).Magnitude
        if distance <= 120 then
            local magn = 5 / 120 * (120 - distance)
            local rought = 20 / 120 * (120 - distance)
            require(game.Players.LocalPlayer.PlayerGui.MainUI.Initiator.Main_Game.camShaker:ShakeOnce(magn,rought,0.1,1))
        end
    end
end)

for i = 0,4 do
    for indx = 1,#game.Workspace.CurrentRooms:GetChildren(),1 do
        local room = game.Workspace.CurrentRooms:GetChildren()[indx]
        if room then
            if room:FindFirstChild("PathfindNodes") then
                for _ , node in room.PathfindNodes do
                    if node.Parent then
                        MoveTo(200,node.CFrame)
                    end
                end
            end
        end
        if room then
            if room:FindFirstChild("RoomExit") then
                MoveTo(200,room.RoomExit.CFrame)
            end
        end
    end
    for indx = #game.Workspace.CurrentRooms:GetChildren(),1,-1 do
        local room = game.Workspace.CurrentRooms:GetChildren()[indx]
        if room then
            if room:FindFirstChild("PathfindNodes") then
                local noder = table.sort(room.PathfindNodes:GetChildren(),function(a,b) return tonumber(a.Name) > tonumber(b.Name) end)
                for _ , node in noder do
                    if node.Parent then
                        MoveTo(200,node.CFrame)
                    end
                end
            end
        end
        if room then
            if room:FindFirstChild("RoomEntrance") then
                MoveTo(200,room.RoomEntrance.CFrame)
            end
        end
    end
end

MoveTo(200, Entity.CFrame - Vector3.new(0,600,0))
model:Destroy()
