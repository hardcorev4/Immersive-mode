local functions = loadstring(game:HttpGet("https://raw.githubusercontent.com/localplayerr/Doors-stuff/refs/heads/main/Functions"))()

local pcal = game.Lighting.EntityFolder:FindFirstChild("Depth_Model")
if not pcal then warn("Depth model not found") return end
local model = game.Lighting.EntityFolder.Depth_Model

local Entity = model.DepthMoving
local entityspeed = 200

local rooms = game.Workspace.CurrentRooms

function MoveTo(speed,pos)
    local distance = (Entity.Position - pos.Position).Magnitude
    local newspeed = distance / speed
    local tweeninfo = TweenInfo.new(newspeed,Enum.EasingStyle.Linear)
    local twening = game:GetService("TweenService"):Create(Entity, tweeninfo, {CFrame = pos.CFrame})
    twening:Play()
    twening.Completed:Wait()
end

local function GetWaypoints()
    local waypoints = {}
    for _ , room: Model in rooms:GetChildren() do
        if room:FindFirstChild("RoomExit") and room:FindFirstChild("RoomEntrance") then
            table.insert(waypoints,room.RoomExit.CFrame)
            if room:FindFirstChild("PathfindNodes") then
                for _ , node in room.PathfindNodes:GetChildren() do
                    table.insert(waypoints,node.CFrame + Vector3.new(0,4,0))
                end
            end
        end
    end
    return waypoints
end

functions.LightRecolor(0.2,Color3.fromRGB(157, 245, 255),Color3.fromRGB(0, 174, 255),Color3.fromRGB(98, 55, 132))

local sound = Instance.new("Sound",game.Workspace)
sound.SoundId = "rbxassetid://12221990"
sound.PlaybackSpeed = 0.2
sound.Volume = 5
local octave = Instance.new("PitchShiftSoundEffect",sound)
octave.Octave = 0.5
local lvl = Instance.new("DistortionSoundEffect",sound)
lvl.Level = 0.85

sound:Play()
wait(2)
sound:Destroy()

model.Parent = game.Workspace
Entity.CFrame = rooms:GetChildren()[1].RoomEntrance.CFrame
task.wait(3)

task.spawn(function()
    while model.Parent and task.wait() do
        local distance = (Entity.Position - pos.Position).Magnitude
        if distance <= 120 then
            local magn = 5 / 120 * (120 - distance)
            local rought = 20 / 120 * (120 - distance)
            require(game.Players.LocalPlayer.PlayerGui.MainUI.Initiator.Main_Game.camShaker:ShakeOnce(magn,rought,0.1,1))
        end
    end
end)

for i = 1,4 do
    local waypoints = GetWaypoints()
    for _ , point in waypoints do
        MoveTo(entityspeed, point)
    end
    for l = #waypoints , 1 , -1 do
        local point = waypoints[l]
        MoveTo(entityspeed, point)
    end
end

MoveTo(entityspeed, Entity.CFrame - Vector3.new(0,500,0))
model:Destroy()
